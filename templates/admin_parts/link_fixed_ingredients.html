<!-- Ø±Ø¨Ø· Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ù…Ø¹ Ø§Ù„Ø£ØµÙ†Ø§Ù -->
<section class="container mb-5">
  <h4 class="color-AB131C fw-bold mb-4">ğŸ”— Ø±Ø¨Ø· Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ù…Ø¹ Ø§Ù„Ø£ØµÙ†Ø§Ù</h4>

  <!-- Ù…ÙƒØ§Ù† Ø¸Ù‡ÙˆØ± Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙÙ„Ø§Ø´ ÙƒÙ€ Toast -->
  <div id="flash-message" class="position-fixed top-0 end-0 p-3" style="z-index: 1055;"></div>

  <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø±Ø¨Ø· -->
  <form method="POST" class="bg-white border border-2 rounded-4 shadow-sm p-4 mb-4">
    <div class="row align-items-center g-3">
      <div class="col-md-4">
        <select id="itemSelect" name="link_fixed_item_id" class="form-control rounded-3 border border-1" required>
  <option disabled selected value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ†Ù</option>
  {% for item in items %}
    <option value="{{ item.id }}">{{ item.name }}</option>
  {% endfor %}
</select>

      </div>
      <div class="col-md-6">
        <label class="fw-semibold mb-2 d-block">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª:</label>
        <div class="d-flex flex-wrap gap-3">
          {% for fixed in fixed_ingredients %}
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="fixed_ingredient_ids" value="{{ fixed.id }}" id="fixed{{ fixed.id }}" >
              <label class="form-check-label" for="fixed{{ fixed.id }}">{{ fixed.name }}</label>
            </div>
          {% endfor %}
        </div>
      </div>
      <div class="col-md-2">
        <button type="submit" name="action" value="link_fixed" class="btn background-color-AB131C text-white w-100 rounded-3 fw-bold">
          ğŸ”— Ø±Ø¨Ø·
        </button>
      </div>
    </div>
  </form>

  <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø­Ø§Ù„ÙŠØ© -->
  <div class="table-responsive shadow-sm rounded-4 overflow-hidden">
    <table class="table table-bordered text-center align-middle m-0">
      <thead class="background-color-AB131C text-white">
        <tr>
          <th>Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù</th>
          <th>Ø§Ù„Ù…ÙƒÙˆÙ† Ø§Ù„Ø«Ø§Ø¨Øª</th>
          <th>Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø¨Ø·</th>
        </tr>
      </thead>
      <tbody>
        {% for link in item_fixed_links %}
        <tr>
          <td>{{ link.item_name }}</td>
          <td>{{ link.ing_name }}</td>
          <td>
            <form method="POST" onsubmit="return confirm('ØªØ£ÙƒÙŠØ¯ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø¨Ø·ØŸ');" style="display:inline;">
              <input type="hidden" name="unlink_fixed_item_id" value="{{ link.item_id }}">
              <input type="hidden" name="unlink_fixed_ing_id" value="{{ link.ing_id }}">
              <button type="submit" name="action" value="unlink_fixed" class="btn no-hover btn-sm rounded-3">
                 Ø¥Ù„ØºØ§Ø¡
              </button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="3" class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>

<!-- Ø³ÙƒØ±Ø¨Øª Ø¹Ø±Ø¶ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙÙ„Ø§Ø´ ÙƒÙ€ Toast Ø¨Ø¯ÙˆÙ† Ø±ÙØ¹ Ø§Ù„ØµÙØ­Ø© -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      let flashContainer = document.getElementById('flash-message');
      {% for message in messages %}
        let toast = document.createElement('div');
        toast.className = 'toast align-items-center text-bg-success border-0 show mb-2 shadow rounded-3';
        toast.setAttribute('role', 'alert');
        toast.setAttribute('aria-live', 'assertive');
        toast.setAttribute('aria-atomic', 'true');
        toast.innerHTML = `
          <div class="d-flex">
            <div class="toast-body">{{ message }}</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
        `;
        flashContainer.appendChild(toast);
        setTimeout(() => { toast.classList.remove('show'); toast.remove(); }, 3000);
      {% endfor %}
    {% endif %}
  {% endwith %}
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  // ÙƒÙˆØ¯ Ø§Ù„ÙÙ„Ø§Ø´ ØªÙˆØ³Øª Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ù‹Ø§ØŒ Ø¨Ù†Ø¶ÙŠÙ Ø¹Ù„ÙŠÙ‡ Ù‡Ø°Ø§:

  // Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù†Ù…ÙˆØ°Ø¬
  const form = document.querySelector('form');
  const itemSelect = document.getElementById('itemSelect');

  form.addEventListener('submit', function (e) {
    // Ø¥Ø°Ø§ Ù…Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ØµÙ†ÙØŒ Ø§Ù…Ù†Ø¹ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
    if (!itemSelect.value) {
      e.preventDefault();
      // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ÙÙ„Ø§Ø´
      const flashContainer = document.getElementById('flash-message');
      let toast = document.createElement('div');
      toast.className = 'toast align-items-center text-bg-danger border-0 show mb-2 shadow rounded-3';
      toast.setAttribute('role', 'alert');
      toast.setAttribute('aria-live', 'assertive');
      toast.setAttribute('aria-atomic', 'true');
      toast.innerHTML = `
        <div class="d-flex">
          <div class="toast-body">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙ†Ù Ù‚Ø¨Ù„ ØªÙ†ÙÙŠØ° Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø±Ø¨Ø·.</div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      `;
      flashContainer.appendChild(toast);
      setTimeout(() => {
        toast.classList.remove('show');
        toast.remove();
      }, 3000);
    }
  });
});
</script>

