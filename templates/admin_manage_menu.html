{% extends 'navbar.html' %}
{% block body %}

<div class="container mt-5">
    <div class="card p-4 rounded-4 shadow-lg mx-auto max-width-800px">
        <h4 class="text-center mb-4 color-AB131C fw-bold">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</h4>

        <!-- Ø§Ù„ÙÙ„ØªØ± -->
        <select id="sectionFilter" class="form-select mb-4 rounded-3 border border-1">
            <option value="items" selected>ğŸ” Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù</option>
            <option value="categories">ğŸ“‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ¦Ø§Øª</option>
            <option value="fixed">ğŸ¥¬ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©</option>
            <option value="custom">ğŸ§‚ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ®ØµÙŠØµ</option>
        </select>

        <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙÙ„Ø§Ø´ -->
        <div id="flash-message" class="alert alert-info text-center" style="display:none;"></div>

        <!-- Ø§Ù„Ø£Ù‚Ø³Ø§Ù… -->
        <div class="section-block" data-section="categories">
            {% include 'admin_parts/manage_categories.html' %}
        </div>

        <div class="section-block" data-section="items">
            {% include 'admin_parts/manage_items.html' %}
        </div>

        <div class="section-block" data-section="fixed">
            {% include 'admin_parts/add_fixed_ingredients.html' %}
            {% include 'admin_parts/link_fixed_ingredients.html' %}
        </div>

        <div class="section-block" data-section="custom">
            {% include 'admin_parts/add_customizable_ingredients.html' %}
            {% include 'admin_parts/add_customizable_options.html' %}
            {% include 'admin_parts/link_customizable_options.html' %}
        </div>
    </div>
</div>

<!-- Ø§Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø© -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        const flashMessage = document.getElementById('flash-message');
        flashMessage.innerText = "{{ messages[0] }}";
        flashMessage.style.display = 'block';
        setTimeout(() => {
          flashMessage.style.display = 'none';
        }, 3000);
      {% endif %}
    {% endwith %}
  });
</script>

<!-- Ø§Ø³ÙƒØ±Ø¨Øª Ø§Ù„ÙÙ„ØªØ±Ø© -->
<script>
function showSelectedSection(selected) {
    const sections = document.querySelectorAll('.section-block');
    sections.forEach(section => {
        const type = section.getAttribute('data-section');
        section.style.display = (type === selected) ? 'block' : 'none';
    });
    // Ø§Ø­ÙØ¸ Ø§Ù„Ø®ÙŠØ§Ø± ÙÙŠ localStorage
    localStorage.setItem("selectedSection", selected);
}

document.addEventListener('DOMContentLoaded', function () {
    const sectionFilter = document.getElementById('sectionFilter');
    const savedSection = localStorage.getItem("selectedSection");

    // Ø¥Ø°Ø§ ÙÙŠ Ø®ÙŠØ§Ø± Ù…Ø­ÙÙˆØ¸ØŒ Ø±Ø¬Ù‘Ø¹Ù‡
    if (savedSection) {
        sectionFilter.value = savedSection;
        showSelectedSection(savedSection);
    } else {
        showSelectedSection(sectionFilter.value); // Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
    }

    // Ù„Ù…Ø§ ØªØªØºÙŠØ± Ø§Ù„Ù‚ÙŠÙ…Ø© Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    sectionFilter.addEventListener('change', function () {
        showSelectedSection(this.value);
    });
});
</script>

{% endblock %}
